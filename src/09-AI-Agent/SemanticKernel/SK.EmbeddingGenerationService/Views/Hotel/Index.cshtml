@using SK.VectorStores.ViewModes
@model HotelSearchVm
@{
    ViewData["Title"] = "酒店查询";
}

<h2>酒店查询</h2>

        <form asp-action="Search" method="post" class="mb-3">
            <div class="row gx-2 align-items-center">
                <div class="col">
                    <input asp-for="Query" class="form-control" placeholder="请输入酒店描述" />
                </div>
                <div class="col-auto" style="min-width: 100px;">
                    <input asp-for="TopK" type="number" min="1" class="form-control" />
                </div>
                <div class="col-auto d-flex">
                    <button type="submit" class="btn btn-primary me-2">Search</button>
                    <a asp-action="Create" class="btn btn-success">新增酒店</a>
                </div>
            </div>
        </form>

@if (Model?.Results?.Any() == true)
{
            <div class="table-responsive">
                <table class="table table-sm align-middle">
                    <thead class="table-light">
                        <tr>
                            <th class="text-end" style="width:110px;">匹配分数</th>
                            <th class="text-end" style="width:90px;">编号</th>
                            <th style="width:200px;">酒店名称</th>
                            <th>酒店描述</th>
                            <th class="text-nowrap" style="width:220px;">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var r in Model.Results)
                        {
                            var fullId = $"desc-{r.HotelId}";
                            <tr>
                                <td class="text-end">
                                    <span class="badge bg-secondary">@r.Score.ToString("0.0000")</span>
                                </td>
                                <td class="text-end">@r.HotelId</td>
                                <td class="text-truncate" style="max-width: 200px;" title="@r.HotelName">
                                    @r.HotelName
                                </td>
                                <td>
                                    <div class="desc-clamp" title="@r.Description">
                                        @r.Description
                                    </div>
                                    <a href="javascript:void(0);" class="small text-decoration-none ms-1"
                                       data-bs-toggle="modal" data-bs-target="#@fullId">展开</a>

                                    <!-- Full description modal -->
                                    <div class="modal fade" id="@fullId" tabindex="-1" aria-hidden="true">
                                        <div class="modal-dialog modal-lg modal-dialog-scrollable">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title">@r.HotelName</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <p class="mb-0">@r.Description</p>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-nowrap">
                                    <div class="btn-group btn-group-sm" role="group">
                                        <a asp-action="Details" asp-route-id="@r.HotelId" class="btn btn-primary">详情</a>
                                        <a asp-action="Edit" asp-route-id="@r.HotelId" class="btn btn-warning">编辑</a>
                                        <a asp-action="Delete" asp-route-id="@r.HotelId" class="btn btn-danger">删除</a>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
}
else
{
            <p class="text-muted">No results yet. Try a query above.</p>
}
